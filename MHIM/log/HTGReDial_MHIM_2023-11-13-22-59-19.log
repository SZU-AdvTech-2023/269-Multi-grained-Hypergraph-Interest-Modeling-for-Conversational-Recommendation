2023-11-13 22:59:19.539 | INFO     | crslab.config.config:__init__:87 - [Dataset: HTGReDial tokenized in pkuseg]
2023-11-13 22:59:19.540 | INFO     | crslab.config.config:__init__:89 - [Model: MHIM]
2023-11-13 22:59:19.540 | INFO     | crslab.config.config:__init__:96 - [Config]
{
    "dataset": "HTGReDial",
    "tokenize": "pkuseg",
    "related_truncate": 1024,
    "context_truncate": 256,
    "response_truncate": 30,
    "scale": 1,
    "model": "MHIM",
    "token_emb_dim": 300,
    "kg_emb_dim": 128,
    "num_bases": 8,
    "n_heads": 2,
    "n_layers": 2,
    "ffn_size": 300,
    "dropout": 0.1,
    "attention_dropout": 0.0,
    "relu_dropout": 0.1,
    "learn_positional_embeddings": false,
    "embeddings_scale": true,
    "reduction": false,
    "n_positions": 1024,
    "user_proj_dim": 512,
    "mha_n_heads": 4,
    "pooling": "Attn",
    "extension_strategy": "Adaptive",
    "rec": {
        "epoch": 6,
        "batch_size": 64,
        "early_stop": true,
        "stop_mode": "min",
        "impatience": 2,
        "optimizer": {
            "name": "Adam",
            "lr": 0.001
        }
    },
    "conv": {
        "epoch": 6,
        "batch_size": 128,
        "impatience": 1,
        "optimizer": {
            "name": "Adam",
            "lr": 0.001
        },
        "lr_scheduler": {
            "name": "ReduceLROnPlateau",
            "patience": 3,
            "factor": 0.5
        },
        "gradient_clip": 0.1
    },
    "pretrain": true,
    "pretrain_epoch": 10,
    "gpu": [
        0
    ],
    "model_name": "MHIM"
}
2023-11-13 22:59:33.799 | INFO     | crslab.data.dataset.base:__init__:49 - [Finish data load]
2023-11-13 23:13:19.615 | INFO     | crslab.data.dataset.base:__init__:57 - [Finish data preprocess]
2023-11-13 23:13:21.506 | INFO     | crslab.model.crs.mhim.mhim:build_model:127 - [Load Pretrain Weights from pretrain/HTGReDial/10-epoch.pth]
2023-11-13 23:13:23.293 | INFO     | crslab.model.crs.mhim.mhim:_build_adjacent_matrix:166 - [Adjacent Matrix built.]
2023-11-13 23:13:24.316 | INFO     | crslab.model:get_model:27 - [Build model MHIM]
2023-11-13 23:13:24.356 | INFO     | crslab.evaluator:get_evaluator:25 - [Build evaluator standard]
2023-11-13 23:13:24.356 | INFO     | crslab.system:get_system:32 - [Build system MHIM]
2023-11-13 23:13:24.540 | INFO     | crslab.system.base:build_optimizer:138 - [Build optimizer: Adam]
2023-11-13 23:13:24.540 | INFO     | crslab.system.mhim:train_recommender:117 - [Recommendation epoch 0]
2023-11-13 23:13:24.540 | INFO     | crslab.system.mhim:train_recommender:118 - [Train]
2023-11-13 23:31:15.858 | INFO     | crslab.evaluator.standard:report:62 - 
    grad norm  rec_loss
        10.67     9.983
2023-11-13 23:31:15.858 | INFO     | crslab.system.mhim:train_recommender:123 - [Valid]
2023-11-13 23:31:53.659 | INFO     | crslab.evaluator.standard:report:62 - 
     hit@1  hit@10  hit@50   mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  rec_loss
   .000999  .01032  .04063 .000999 .002908 .004207 .000999  .004597    .0111     9.714
2023-11-13 23:31:53.660 | INFO     | crslab.system.base:early_stop:249 - [Get new best model]
2023-11-13 23:31:53.660 | INFO     | crslab.system.mhim:train_recommender:117 - [Recommendation epoch 1]
2023-11-13 23:31:53.660 | INFO     | crslab.system.mhim:train_recommender:118 - [Train]
2023-11-13 23:49:51.161 | INFO     | crslab.evaluator.standard:report:62 - 
    grad norm  rec_loss
        11.93      8.91
2023-11-13 23:49:51.162 | INFO     | crslab.system.mhim:train_recommender:123 - [Valid]
2023-11-13 23:50:28.695 | INFO     | crslab.evaluator.standard:report:62 - 
     hit@1  hit@10  hit@50   mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  rec_loss
   .001332  .01998  .05528 .001332 .005315 .006758 .001332  .008662   .01612     9.627
2023-11-13 23:50:28.695 | INFO     | crslab.system.base:early_stop:249 - [Get new best model]
2023-11-13 23:50:28.695 | INFO     | crslab.system.mhim:train_recommender:117 - [Recommendation epoch 2]
2023-11-13 23:50:28.695 | INFO     | crslab.system.mhim:train_recommender:118 - [Train]
2023-11-14 00:08:25.475 | INFO     | crslab.evaluator.standard:report:62 - 
    grad norm  rec_loss
        14.33     8.153
2023-11-14 00:08:25.475 | INFO     | crslab.system.mhim:train_recommender:123 - [Valid]
2023-11-14 00:09:03.103 | INFO     | crslab.evaluator.standard:report:62 - 
     hit@1  hit@10  hit@50   mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  rec_loss
   .002664  .02331  .07226 .002664 .007271  .00935 .002664   .01096   .02143     9.648
2023-11-14 00:09:03.103 | INFO     | crslab.system.mhim:train_recommender:117 - [Recommendation epoch 3]
2023-11-14 00:09:03.103 | INFO     | crslab.system.mhim:train_recommender:118 - [Train]
2023-11-14 00:26:51.076 | INFO     | crslab.evaluator.standard:report:62 - 
    grad norm  rec_loss
        16.54     7.238
2023-11-14 00:26:51.077 | INFO     | crslab.system.mhim:train_recommender:123 - [Valid]
2023-11-14 00:27:28.404 | INFO     | crslab.evaluator.standard:report:62 - 
     hit@1  hit@10  hit@50   mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  rec_loss
   .001998  .02631  .07193 .001998 .007675 .009589 .001998   .01198   .02169     10.15
2023-11-14 00:27:28.404 | INFO     | crslab.system.base:early_stop:254 - [Early stop]
2023-11-14 00:27:28.405 | INFO     | crslab.system.mhim:train_recommender:134 - [Test]
2023-11-14 00:28:14.759 | INFO     | crslab.evaluator.standard:report:62 - 
     hit@1  hit@10  hit@50   mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  rec_loss
   .006346  .02939  .07348 .006346  .01201  .01404 .006346   .01604   .02567     10.25
2023-11-14 00:28:14.760 | INFO     | crslab.system.base:build_optimizer:138 - [Build optimizer: Adam]
2023-11-14 00:28:14.761 | INFO     | crslab.system.base:build_lr_scheduler:155 - [Build scheduler ReduceLROnPlateau]
2023-11-14 00:28:14.761 | INFO     | crslab.system.mhim:train_conversation:151 - [Conversation epoch 0]
2023-11-14 00:28:14.761 | INFO     | crslab.system.mhim:train_conversation:152 - [Train]
2023-11-14 00:45:14.281 | INFO     | crslab.evaluator.standard:report:62 - 
    gen_loss  grad clip ratio  grad norm   ppl
       4.567                1      4.753 96.29
2023-11-14 00:45:14.281 | INFO     | crslab.system.mhim:train_conversation:157 - [Valid]
2023-11-14 00:47:22.071 | INFO     | crslab.evaluator.standard:report:62 - 
    bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4    f1  gen_loss   ppl
     .3773   .1097  .03997  .01821  .03786   .6386   3.006   7.108 .3955     4.053 57.56
2023-11-14 00:47:22.074 | INFO     | crslab.system.mhim:train_conversation:151 - [Conversation epoch 1]
2023-11-14 00:47:22.074 | INFO     | crslab.system.mhim:train_conversation:152 - [Train]
2023-11-14 01:04:20.813 | INFO     | crslab.evaluator.standard:report:62 - 
    gen_loss  grad clip ratio  grad norm   ppl
       3.729                1      2.486 41.65
2023-11-14 01:04:20.814 | INFO     | crslab.system.mhim:train_conversation:157 - [Valid]
2023-11-14 01:06:28.709 | INFO     | crslab.evaluator.standard:report:62 - 
    bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4    f1  gen_loss   ppl
     .3983   .1211  .04437  .01915   .1097   1.144   4.483   9.509 .4160     3.834 46.24
2023-11-14 01:06:28.713 | INFO     | crslab.system.mhim:train_conversation:151 - [Conversation epoch 2]
2023-11-14 01:06:28.713 | INFO     | crslab.system.mhim:train_conversation:152 - [Train]
2023-11-14 01:23:28.698 | INFO     | crslab.evaluator.standard:report:62 - 
    gen_loss  grad clip ratio  grad norm   ppl
       3.377                1      2.188 29.29
2023-11-14 01:23:28.699 | INFO     | crslab.system.mhim:train_conversation:157 - [Valid]
2023-11-14 01:25:36.846 | INFO     | crslab.evaluator.standard:report:62 - 
    bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4    f1  gen_loss   ppl
     .4036   .1256  .04741  .02116   .2849   2.077   6.543   11.74 .4207      3.77 43.38
2023-11-14 01:25:36.852 | INFO     | crslab.system.mhim:train_conversation:151 - [Conversation epoch 3]
2023-11-14 01:25:36.852 | INFO     | crslab.system.mhim:train_conversation:152 - [Train]
2023-11-14 01:42:35.675 | INFO     | crslab.evaluator.standard:report:62 - 
    gen_loss  grad clip ratio  grad norm   ppl
       3.106                1      2.056 22.33
2023-11-14 01:42:35.676 | INFO     | crslab.system.mhim:train_conversation:157 - [Valid]
2023-11-14 01:44:43.302 | INFO     | crslab.evaluator.standard:report:62 - 
    bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4    f1  gen_loss   ppl
     .4109   .1333  .05279  .02331   .4866   2.663   7.341   12.65 .4269     3.744 42.27
2023-11-14 01:44:43.308 | INFO     | crslab.system.mhim:train_conversation:151 - [Conversation epoch 4]
2023-11-14 01:44:43.308 | INFO     | crslab.system.mhim:train_conversation:152 - [Train]
2023-11-14 02:01:49.305 | INFO     | crslab.evaluator.standard:report:62 - 
    gen_loss  grad clip ratio  grad norm   ppl
       2.895                1      2.013 18.08
2023-11-14 02:01:49.306 | INFO     | crslab.system.mhim:train_conversation:157 - [Valid]
2023-11-14 02:03:58.098 | INFO     | crslab.evaluator.standard:report:62 - 
    bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4    f1  gen_loss   ppl
     .4147   .1351  .05334  .02424   .5942   3.172   8.082   13.17 .4309     3.763 43.06
2023-11-14 02:03:58.105 | INFO     | crslab.system.mhim:train_conversation:151 - [Conversation epoch 5]
2023-11-14 02:03:58.105 | INFO     | crslab.system.mhim:train_conversation:152 - [Train]
2023-11-14 02:21:05.565 | INFO     | crslab.evaluator.standard:report:62 - 
    gen_loss  grad clip ratio  grad norm   ppl
       2.729                1        1.9 15.31
2023-11-14 02:21:05.565 | INFO     | crslab.system.mhim:train_conversation:157 - [Valid]
2023-11-14 02:23:14.454 | INFO     | crslab.evaluator.standard:report:62 - 
    bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4    f1  gen_loss   ppl
     .4229   .1419   .0571  .02618   .7793   3.935   9.308   14.29 .4341     3.797 44.58
2023-11-14 02:23:14.455 | INFO     | crslab.system.mhim:train_conversation:168 - [Test]
2023-11-14 02:26:21.858 | INFO     | crslab.evaluator.standard:report:62 - 
    bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4    f1
     .3133  .06396   .0251  .01316   .5586   1.572   3.227   5.034 .3495
